import{_ as I,I as V,a as y,b as e,f as L,h as f,i as _,y as w,w as A,z as G,A as F,k as j,p as C,F as z,e as R,r as b,B as N,x as Y,o as S,t as m,n as q}from"./index-Dq8SOG-H.js";import{d as T,g as h,S as c,f as K,s as O,c as u,a as E,v as H,b as J,e as P}from"./api-DaGFE-z-.js";import{M as Q}from"./Modal-DtVLPGaN.js";import{L as W}from"./LoadingSpinner-DrFe2eLo.js";import{E as X}from"./EmptyState-CugYfD8-.js";import{f as Z}from"./format-sbWH3_uq.js";async function $(a={}){await T();let t=h(c.STUDENTS)||[];return a.grade&&(t=t.filter(n=>n.grade===a.grade)),a.class&&(t=t.filter(n=>n.class===a.class)),a.status&&(t=t.filter(n=>n.status===a.status)),a.search&&(t=K(t,a.search,["name","email","grade","class"])),a.sortBy&&(t=O(t,a.sortBy,a.order||"asc")),u(t)}async function tt(a){await T(500);const t=H(a,["name","email","grade","class"]);if(!t.valid)return u(null,!1,`Missing required fields: ${t.missing.join(", ")}`);const n=h(c.STUDENTS)||[];if(n.find(d=>d.email===a.email))return u(null,!1,"Student with this email already exists");const r=new J({...a,id:P("student"),enrolledAt:new Date,status:a.status||"active"});return n.push(r),E(c.STUDENTS,n),u(r,!0,"Student created successfully")}async function et(a,t){await T(500);const n=h(c.STUDENTS)||[],s=n.findIndex(r=>r.id===a);return s===-1?u(null,!1,"Student not found"):t.email&&t.email!==n[s].email&&n.find(d=>d.email===t.email&&d.id!==a)?u(null,!1,"Student with this email already exists"):(n[s]={...n[s],...t},E(c.STUDENTS,n),u(n[s],!0,"Student updated successfully"))}async function st(a){await T(500);const t=h(c.STUDENTS)||[],n=t.filter(d=>d.id!==a);if(n.length===t.length)return u(null,!1,"Student not found");E(c.STUDENTS,n);const r=(h(c.EVENTS)||[]).filter(d=>d.studentId!==a);return E(c.EVENTS,r),u(null,!0,"Student deleted successfully")}const at={name:"StudentManagement",components:{Modal:Q,LoadingSpinner:W,EmptyState:X,Icon:V},setup(){const a=b(!1),t=b(!1),n=b(!1),s=b(null),r=b([]),d=N({search:"",grade:"",class:""}),i=N({name:"",email:"",grade:"",class:"",status:"active"}),v=async()=>{a.value=!0;try{const o=await $(d);o.success&&(r.value=o.data)}catch(o){console.error("Failed to load students:",o)}finally{a.value=!1}},k=()=>{v()},g=()=>{i.name="",i.email="",i.grade="",i.class="",i.status="active",s.value=null},l=o=>{s.value=o,i.name=o.name,i.email=o.email,i.grade=o.grade,i.class=o.class,i.status=o.status,n.value=!0},M=async()=>{t.value=!0;try{let o;s.value?o=await et(s.value.id,{...i}):o=await tt({...i}),o.success?(n.value=!1,g(),v()):alert("Error: "+o.message)}catch(o){console.error("Failed to save student:",o),alert("Failed to save student")}finally{t.value=!1}},D=async o=>{if(confirm(`Are you sure you want to delete student "${o.name}"?`))try{const p=await st(o.id);p.success?v():alert("Error: "+p.message)}catch(p){console.error("Failed to delete student:",p),alert("Failed to delete student")}},x=()=>{n.value=!1,g()},B=o=>o.split(" ").map(p=>p[0]).join("").toUpperCase().slice(0,2),U=o=>Z(new Date(o),"MMM dd, yyyy");return Y(()=>{v()}),{loading:a,saving:t,showAddModal:n,editingStudent:s,studentList:r,filters:d,form:i,applyFilters:k,editStudent:l,saveStudent:M,confirmDelete:D,closeModal:x,getInitials:B,formatDate:U}}},nt={class:"student-management"},lt={class:"page-header"},ot={class:"card mb-3"},it={class:"form-row"},dt={class:"form-group"},rt={class:"form-group"},ct={class:"form-group"},ut={key:1},ft={key:2},mt={class:"students-grid"},vt={class:"student-header"},pt={class:"student-avatar"},St={class:"student-info"},gt={class:"student-meta"},yt={class:"student-details"},_t={class:"detail-item"},bt={class:"detail-value"},ht={class:"detail-item"},wt={class:"detail-value"},Et={class:"detail-item"},Tt={class:"detail-item"},kt={class:"detail-value"},Mt={class:"student-actions"},At=["onClick"],Ct=["onClick"];function Ft(a,t,n,s,r,d){const i=w("Icon"),v=w("LoadingSpinner"),k=w("EmptyState"),g=w("router-link");return S(),y("div",nt,[e("div",lt,[t[7]||(t[7]=e("div",null,[e("h1",null,"Student Management"),e("p",null,"Manage students and their information")],-1)),e("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=l=>s.showAddModal=!0)},[f(i,{name:"add"}),t[6]||(t[6]=_(" Add Student ",-1))])]),e("div",ot,[e("div",it,[e("div",dt,[A(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.filters.search=l),type:"text",class:"form-input",placeholder:"Search students..."},null,512),[[G,s.filters.search]])]),e("div",rt,[A(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.filters.grade=l),class:"form-select"},[...t[8]||(t[8]=[j('<option value="" data-v-4b4aa25d>All Grades</option><option value="9" data-v-4b4aa25d>Grade 9</option><option value="10" data-v-4b4aa25d>Grade 10</option><option value="11" data-v-4b4aa25d>Grade 11</option><option value="12" data-v-4b4aa25d>Grade 12</option>',5)])],512),[[F,s.filters.grade]])]),e("div",ct,[A(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.filters.class=l),class:"form-select"},[...t[9]||(t[9]=[e("option",{value:""},"All Classes",-1),e("option",{value:"10-A"},"10-A",-1),e("option",{value:"10-B"},"10-B",-1),e("option",{value:"10-C"},"10-C",-1)])],512),[[F,s.filters.class]])]),e("button",{class:"btn btn-secondary",onClick:t[4]||(t[4]=(...l)=>s.applyFilters&&s.applyFilters(...l))},[f(i,{name:"search"}),t[10]||(t[10]=_(" Search ",-1))])])]),s.loading?(S(),L(v,{key:0})):s.studentList.length===0?(S(),y("div",ut,[f(k,{icon:"users",message:"No students available yet"},{action:C(()=>[e("button",{class:"btn btn-primary mt-2",onClick:t[5]||(t[5]=l=>s.showAddModal=!0)}," Add Your First Student ")]),_:1})])):(S(),y("div",ft,[e("div",mt,[(S(!0),y(z,null,R(s.studentList,l=>(S(),y("div",{key:l.id,class:"student-card card"},[e("div",vt,[e("div",pt,m(s.getInitials(l.name)),1),e("div",St,[f(g,{to:`/students/${l.id}`,class:"student-name"},{default:C(()=>[_(m(l.name),1)]),_:2},1032,["to"]),e("p",gt,m(l.email),1)])]),e("div",yt,[e("div",_t,[t[11]||(t[11]=e("span",{class:"detail-label"},"Grade:",-1)),e("span",bt,m(l.grade),1)]),e("div",ht,[t[12]||(t[12]=e("span",{class:"detail-label"},"Class:",-1)),e("span",wt,m(l.class),1)]),e("div",Et,[t[13]||(t[13]=e("span",{class:"detail-label"},"Status:",-1)),e("span",{class:q(["badge",l.status==="active"?"badge-success":"badge-danger"])},m(l.status),3)]),e("div",Tt,[t[14]||(t[14]=e("span",{class:"detail-label"},"Enrolled:",-1)),e("span",kt,m(s.formatDate(l.enrolledAt)),1)])]),e("div",Mt,[f(g,{to:`/students/${l.id}`,class:"btn btn-small btn-secondary"},{default:C(()=>[f(i,{name:"chart"}),t[15]||(t[15]=_(" View Details ",-1))]),_:1},8,["to"]),e("button",{class:"btn btn-small btn-secondary",onClick:M=>s.editStudent(l)},[f(i,{name:"edit"}),t[16]||(t[16]=_(" Edit ",-1))],8,At),e("button",{class:"btn btn-small btn-danger",onClick:M=>s.confirmDelete(l)},[f(i,{name:"delete"})],8,Ct)])]))),128))])]))])}const Vt=I(at,[["render",Ft],["__scopeId","data-v-4b4aa25d"]]);export{Vt as default};
